import numpy as np
import matplotlib.pyplot as plt

p_p = [1, 0.0001]
p_s = [1, 0.001]
p_x = [2, 0.5]

"""# Parameters
T = 2500*u.K
m = 40.*c.m_p
lambda_0 = 4227*u.Angstrom
nu_0 = c.c/lambda_0

def compute_xi_0(T,m):
    return (2*c.k_B*T/m)**(1/2)

def compute_doppler_lambda(T,m,nu_0):
    xi_0 = compute_xi_0(T,m)
    return (xi_0/nu_0).to(u.Angstrom)

print(compute_doppler_lambda(T,m,nu_0))

x_range = np.linspace(-5,5)

def compute_profile(const,p_p,p_s,p_x,gamma_r,gamma_vdW,gamma_s,T,m,nu_0,x):
    doppler_lambda = compute_doppler_lambda(T, m, nu_0)
    a_damping = (gamma_r+gamma_s+gamma_vdW)/doppler_lambda
    return const*np.exp(-p_p*x**2)+p_s*a_damping/(1+np.abs(x)**p_x)

case = 1
profile = compute_profile(1,p_p[case],p_s[case],p_x[case],2.18e8*u.Hz,0*u.Hz,0*u.Hz,T,m,nu_0,x_range)
plt.plot(x_range,profile)
plt.show()"""

data_m = """4195.476276060388, 14316.889335980168
4196.187994248741, 14157.844922791312
4196.899712437095, 13942.039700029816
4197.611430625449, 13729.523953486256
4198.323148813803, 13577.004503953534
4199.034867002157, 13332.765689518114
4199.74658519051, 13203.07740651267
4200.458303378864, 12947.473017551582
4201.170021567217, 12750.117253733799
4201.881739755571, 12503.281926674774
4202.5934579439245, 12261.225197135404
4203.305176132279, 12074.329772766327
4204.016894320633, 11840.577323344221
4204.728612508986, 11660.09375110396
4205.44033069734, 11434.36068549234
4206.152048885693, 11212.997689109867
4206.863767074047, 11042.08018878981
4207.5754852624, 10813.201655978031
4208.2872034507545, 10574.291251282137
4208.998921639109, 10340.659411001103
4209.710639827462, 10098.078915375636
4210.422358015816, 9847.428744996585
4211.134076204169, 9629.85644203483
4211.845794392523, 9390.828288447456
4212.557512580876, 9119.450435757879
4213.2692307692305, 8868.289759578825
4213.980948957584, 8612.012319712938
4214.692667145938, 8328.179772039644
4215.404385334292, 8020.034218286084
4216.116103522645, 7723.290157403376
4216.827821710999, 7427.147374273029
4217.539539899352, 7142.35992626706
4218.251258087706, 6878.090120039307
4218.96297627606, 6586.705307184785
4219.674694464414, 6246.309901768906
4220.386412652768, 5931.783081421089
4221.098130841121, 5562.743538888964
4221.809849029475, 5223.952923682942
4222.521567217828, 4831.017773306473
4223.233285406182, 4436.554468156175
4223.945003594536, 3995.423737161221
4224.65672178289, 3533.427281985032
4225.368439971244, 3030.315160337592
4226.080158159597, 2450.8062245146793
4226.630122214234, 1932.0221043497413
4227.309489575844, 1175.7682510028555
4227.541468102742, 803.9305626864855
4227.6230244611515, 598.1428938605648
4227.709732017518, 365.4115701857379
4227.736066583885, 194.16288436974287
4227.794751976995, 0.011808586125850692
4227.905166207549, 193.83664726597254
4227.928640364793, 363.8486578444857
4227.975588679281, 587.5701419257132
4228.046011151013, 793.8740605744304
4228.215312724658, 1055.90750643421
4228.571171818835, 1514.9228696425507
4229.1858375269585, 2161.371437137848
4229.897555715313, 2775.122137209805
4230.609273903666, 3318.2291528099845
4231.32099209202, 3794.2380861521906
4232.032710280373, 4242.674849977976
4232.744428468727, 4645.776636487633
4233.456146657081, 5044.733909693548
4234.167864845434, 5417.097907250439
4234.879583033789, 5768.414613093713
4235.591301222142, 6116.837354806612
4236.303019410496, 6441.176491518805
4237.014737598849, 6754.359102935422
4237.726455787203, 7072.885938872767
4238.438173975557, 7365.180654582807
4239.14989216391, 7658.8526375652955
4239.8616103522645, 7953.120881675584
4240.573328540618, 8212.695009700852
4241.285046728972, 8492.591723229214
4241.996764917325, 8757.5357322953
4242.708483105679, 8992.993323272203
4243.420201294032, 9234.781493859991
4244.131919482386, 9456.623478909512
4244.8436376707405, 9697.32634130936
4245.555355859094, 9930.279782239091
4246.267074047448, 10168.829333244023
4246.978792235801, 10427.660229200315
4247.690510424155, 10693.079241694519
4248.402228612508, 10965.254060442929
4249.113946800862, 11150.541903918906
4249.825664989216, 11386.560777164861
4250.53738317757, 11611.3501940549
4251.249101365924, 11824.054929998772
4251.960819554277, 12074.329772766327
4252.672537742631, 12227.03033716733
4253.384255930984, 12468.412003991665
4254.095974119338, 12626.096412652409
4254.8076923076915, 12875.35629943839
4255.519410496046, 13019.99367175095
4256.2311286844, 13277.029737571189
4256.942846872753, 13444.940501369292
4257.654565061107, 13710.36571575759
4258.36628324946, 13845.036878722718
4259.078001437814, 14098.659830765773
4259.660316319194, 14157.844922791312"""

data_l = """4195.476276060388, 2643099.8402933823
4196.187994248741, 2527595.0738082547
4196.899712437095, 2417137.9225805607
4197.611430625449, 2305061.3280123323
4198.323148813803, 2198181.4427144635
4199.034867002157, 2093332.181763523
4199.74658519051, 1993484.040059765
4200.458303378864, 1893104.1027216292
4201.170021567217, 1795270.0706088725
4201.881739755571, 1697744.0046181076
4202.5934579439245, 1605515.9345686527
4203.305176132279, 1518298.0526758984
4204.016894320633, 1433814.6390237308
4204.728612508986, 1344611.394198669
4205.44033069734, 1262719.8386615645
4206.152048885693, 1182508.6903797055
4206.863767074047, 1110489.758732135
4207.5754852624, 1037048.3761573099
4208.2872034507545, 965763.0707008655
4208.998921639109, 895618.0849228849
4209.710639827462, 829408.8686828538
4210.422358015816, 764883.2953780813
4211.134076204169, 702428.879578531
4211.845794392523, 641480.9782028524
4212.557512580876, 588280.5986284097
4213.2692307692305, 532754.7271264264
4213.980948957584, 482469.760072496
4214.692667145938, 435712.48557324766
4215.404385334292, 389659.1103092977
4216.116103522645, 346532.4472321684
4216.827821710999, 305607.732670667
4217.539539899352, 266894.54328254785
4218.251258087706, 230818.15912966966
4218.96297627606, 198229.39398196957
4219.674694464414, 167412.87626580917
4220.386412652768, 139621.30918352286
4221.098130841121, 113870.57661527445
4221.809849029475, 90817.2400798685
4222.521567217828, 70633.24617357686
4223.233285406182, 52754.9581971022
4223.912652767793, 38306.04547066473
4224.494967649173, 27617.128097504672
4224.980230050323, 19980.87354936373
4225.400790797987, 14524.968890563914
4225.756649892163, 10574.291251282137
4226.080158159597, 7427.147374273029
4226.371315600287, 5137.146831208718
4226.597771387491, 3463.409601358654
4226.791876347951, 2407.838786732957
4226.985981308411, 1586.36467204045
4227.147735442128, 1051.8605526310682
4227.257728253055, 699.5962519703971
4227.335370237239, 472.14356408021547
4227.477153476715, 271.70069614857255
4227.533143372074, 176.72880662906903
4227.599726392074, 83.19151199970209
4227.676442224485, 40.745133189462656
4227.710245010916, 18.77773687861326
4227.793300017307, 0.01328763783097404
4227.913787709348, 27.710078730479445
4227.963765909151, 58.517411736528715
4228.024009755171, 112.55156526615568
4228.150611071172, 204.10161058944885
4228.193745506829, 337.10128328712597
4228.247663551401, 533.0570333848497
4228.377066858375, 798.8017808015685
4228.512940330697, 1309.234920333856
4228.723682859197, 2035.0068223863673
4228.936274006367, 3121.736909678757
4229.147016534866, 4501.453724868586
4229.444644140905, 6878.090120039307
4229.768152408339, 9913.653996427029
4230.124011502516, 13729.523953486256
4230.544572250179, 19164.95997781875
4231.062185478073, 27172.96794177613
4231.6768511861965, 38247.251909118975
4232.356218547807, 52828.675561865544
4233.067936736161, 70731.94583993117
4233.779654924514, 91071.22512133686
4234.491373112868, 113553.00733820451
4235.203091301221, 139426.48099848253
4235.914809489575, 167179.26760660103
4236.6265276779295, 197400.7209043246
4237.338245866283, 230818.15912966966
4238.049964054637, 267267.489505478
4238.76168224299, 305181.2863048601
4239.473400431344, 346048.89434080437
4240.185118619697, 390203.6021210563
4240.896836808051, 435712.48557324766
4241.6085549964055, 484495.1311001109
4242.320273184759, 534244.6615413312
4243.031991373113, 589102.6350199503
4243.743709561466, 645074.0052076337
4244.45542774982, 703410.4215549772
4245.167145938173, 764883.2953780813
4245.878864126527, 825941.6291073749
4246.590582314881, 895618.0849228849
4247.302300503235, 963069.6911703523
4248.014018691589, 1035601.274320869
4248.725736879942, 1110489.758732135
4249.437455068296, 1185815.7664205392
4250.149173256649, 1262719.8386615645
4250.860891445003, 1344611.394198669
4251.5726096333565, 1431813.8878100456
4252.284327821711, 1520419.6529044542
4252.996046010065, 1610006.018509333
4253.707764198418, 1697744.0046181076
4254.419482386772, 1792764.9429062328
4255.131200575125, 1890462.4569830098
4255.842918763479, 1993484.040059765
4256.554636951832, 2093332.181763523
4257.2663551401865, 2198181.4427144635
4257.978073328541, 2305061.3280123323
4258.689791516894, 2417137.9225805607
4259.401509705248, 2527595.0738082547
4259.822070452911, 2604629.4836117853
"""

data_m_wavelength = np.array(data_m.replace(",", "").rsplit()[0::2], dtype=float)
data_m_inv_phi = np.array(data_m.replace(",", "").rsplit()[1::2], dtype=float)
data_m_phi = 1 / data_m_inv_phi

data_l_wavelength = np.array(data_l.replace(",", "").rsplit()[0::2], dtype=float)
data_l_inv_phi = np.array(data_l.replace(",", "").rsplit()[1::2], dtype=float)
data_l_phi = 1 / data_l_inv_phi

plt.plot(data_l_wavelength, 1 / data_l_phi, label="Lorentzian")
plt.plot(data_m_wavelength, 1 / data_m_phi, label="Modified Lorentzian")
plt.xlabel(r"Wavelength, $\AA$")
plt.ylabel(r"Line Profile, $\AA^{-1}$")
plt.yscale("log")
plt.legend()
plt.show()
